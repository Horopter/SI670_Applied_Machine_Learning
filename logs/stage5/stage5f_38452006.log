2025-12-16 03:12:59 [INFO] [__main__:310] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-16 03:12:59 [INFO] [__main__:312] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-16 03:12:59 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-16 03:12:59 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-16 03:12:59 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-16 03:12:59 [INFO] [__main__:317] Model types: ['xgboost_pretrained_inception']
2025-12-16 03:12:59 [INFO] [__main__:318] K-fold splits: 5
2025-12-16 03:12:59 [INFO] [__main__:319] Number of frames: 1000
2025-12-16 03:12:59 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-16 03:12:59 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-16 03:12:59 [INFO] [__main__:324] Delete existing: True
2025-12-16 03:12:59 [INFO] [__main__:325] Resume mode: True
2025-12-16 03:12:59 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765872779.log
2025-12-16 03:12:59 [INFO] [__main__:333] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:334] Checking prerequisites...
2025-12-16 03:12:59 [INFO] [__main__:335] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-16 03:12:59 [INFO] [__main__:352] ✓ All model types are valid
2025-12-16 03:12:59 [INFO] [__main__:358] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:359] Initial memory statistics:
2025-12-16 03:12:59 [INFO] [__main__:360] ================================================================================
2025-12-16 03:12:59 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.92578125, 'cpu_memory_gb': 0.7186775207519531, 'cpu_vms_mb': 10218.66015625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-16 03:12:59 [INFO] [__main__:364] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-16 03:12:59 [INFO] [__main__:366] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-16 03:12:59 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-16 03:12:59 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-16 03:12:59 [INFO] [__main__:370] ================================================================================
2025-12-16 03:12:59 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-16 03:12:59 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1443] Applied global PyTorch memory optimizations at pipeline start
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1446] ================================================================================
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1447] Stage 5: Model Training Pipeline Started
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1448] ================================================================================
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1449] Model types: ['xgboost_pretrained_inception']
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1450] K-fold splits: 5
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1451] Frames per video: 1000
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1452] Output directory: data/stage5
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:1453] Initializing pipeline...
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:246] ================================================================================
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:247] STAGE 5 PREREQUISITE VALIDATION
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:248] ================================================================================
2025-12-16 03:12:59 [INFO] [lib.training.pipeline:250] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:259] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:260]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:262] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:270] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:271]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:273] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:281] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:282]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:284] 
================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:285] MODEL REQUIREMENTS CHECK
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:286] ================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:305] ✓ xgboost_pretrained_inception: CAN RUN
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:308] VALIDATION SUMMARY
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:310] Stage 3 (scaled videos): ✓ Available
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:311]   Count: 3278 videos
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:312] Stage 2 (features): ✓ Available
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:313]   Count: 3278 feature rows
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:314] Stage 4 (scaled features): ✓ Available
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:315]   Count: 3277 feature rows
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:316] 
Runnable models: 1/1
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:317]   ['xgboost_pretrained_inception']
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:324] ================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1534] 
Stage 5: Loading metadata...
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1558] Loaded metadata: 3278 rows
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1568] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-16 03:13:01 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=805912.96GB, used=1693927.04GB (67.8%)
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1589] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1599] Stage 5: Found 3278 scaled videos
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1602] ================================================================================
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1603] STAGE 5: VALIDATING VIDEOS (checking for corruption and empty videos)
2025-12-16 03:13:01 [INFO] [lib.training.pipeline:1604] ================================================================================
2025-12-16 03:13:01 [INFO] [lib.data.loading:156] Checking file existence for 3278 videos...
2025-12-16 03:13:05 [INFO] [lib.data.loading:166] Found 3278 existing video files (filtered out 0 missing files)
2025-12-16 03:13:05 [INFO] [lib.data.loading:170] Checking for corrupted videos (moov atom errors, etc.)...
2025-12-16 03:13:05 [INFO] [lib.data.loading:92] Loaded validation cache from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/.video_validation_cache/validation_0192be168a40eb7e_corruptTrue_framesTrue.parquet (3278 entries)
2025-12-16 03:13:05 [INFO] [lib.data.loading:194] Cache hit: 3278 videos, Cache miss: 0 videos
2025-12-16 03:13:06 [WARNING] [lib.data.loading:306] Filtered out 1 corrupted videos and 0 empty videos. Keeping 3277 valid videos.
2025-12-16 03:13:06 [WARNING] [lib.data.loading:311] Sample of invalid videos:
2025-12-16 03:13:06 [WARNING] [lib.data.loading:313]   data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: Corrupted video: moov atom not found
2025-12-16 03:13:06 [INFO] [lib.data.loading:323] Found /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/skip_frame_check.txt - skipping frame check as requested.
2025-12-16 03:13:06 [WARNING] [lib.data.loading:387] Filtered out 1 invalid videos (corrupted). Keeping 3277 valid videos.
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1613] ✓ Video validation complete: 3277 valid videos ready for training
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1614] ================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1700] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1773] Overriding num_frames to 400 for xgboost_pretrained_inception. Original num_frames was 1000.
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1801] Stage 5: Deleting existing model results (clean mode)...
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1809] Deleted existing results for xgboost_pretrained_inception
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1812] Stage 5: Deleted 1 existing model directories
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1816] 
================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1817] Stage 5: Training model: xgboost_pretrained_inception
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1818] ================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1836] Overriding model_config num_frames to 400 for xgboost_pretrained_inception (XGBoost pretrained model with enhanced feature extraction) to improve feature quality.
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1854] Grid search: 1 hyperparameter combinations to try
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1862] ================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1863] HYPERPARAMETER SEARCH: Using 10.0% stratified sample for efficiency
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1864] ================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1873] Hyperparameter search sample: 327 rows (10.0% of 3277 total)
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1874] To change sample size, set FVC_GRID_SEARCH_SAMPLE_SIZE environment variable (current: 0.1)
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1886] Using 5-fold stratified cross-validation on 10.0% sample for hyperparameter search
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1897] 
================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1898] Grid Search: Hyperparameter combination 1/1
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1899] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1900] ================================================================================
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:1918] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 1/5 (10.0% sample)
2025-12-16 03:13:06 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 1...
2025-12-16 03:13:06 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 03:13:06 [INFO] [lib.training._xgboost_pretrained:637] Processing 261 videos...
2025-12-16 03:13:06 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 03:13:07 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 03:13:07 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 03:13:07 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 03:28:21 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-16 03:28:21 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 03:28:22 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 03:28:22 [INFO] [lib.training.feature_preprocessing:77] Removed 9 features with zero variance
2025-12-16 03:28:22 [INFO] [lib.training.feature_preprocessing:141] Removed 442 collinear features (correlation >= 0.95)
2025-12-16 03:28:22 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1981/2432 (81.5% retained)
2025-12-16 03:28:22 [INFO] [lib.training._xgboost_pretrained:667] Using 1981 features after collinearity removal
2025-12-16 03:28:22 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-16 03:28:22 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-16 03:28:22 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 03:28:27 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 92 (out of 200)
2025-12-16 03:28:27 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 03:28:27 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 03:28:28 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 03:28:28 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 03:28:28 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 03:32:23 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (66, 2432)
2025-12-16 03:32:23 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 03:32:23 [INFO] [lib.training.pipeline:500] Fold 1 - Val Loss: 0.6439, Val Acc: 0.6364, Val F1: 0.7000, Val Precision: 0.6087, Val Recall: 0.8235
2025-12-16 03:32:23 [INFO] [lib.training.pipeline:505]   Class 0 - Precision: 0.7000, Recall: 0.4375, F1: 0.5385
2025-12-16 03:32:23 [INFO] [lib.training.pipeline:509]   Class 1 - Precision: 0.6087, Recall: 0.8235, F1: 0.7000
2025-12-16 03:32:23 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_1
2025-12-16 03:32:23 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_1
2025-12-16 03:32:26 [INFO] [lib.training.visualization:480] Generated fold 1 plots: ROC/PR curves and confusion matrix
2025-12-16 03:32:26 [INFO] [lib.training.pipeline:1918] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 2/5 (10.0% sample)
2025-12-16 03:32:26 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 2...
2025-12-16 03:32:26 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 03:32:26 [INFO] [lib.training._xgboost_pretrained:637] Processing 261 videos...
2025-12-16 03:32:26 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 03:32:27 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 03:32:28 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 03:32:28 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 03:47:35 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 03:47:36 [INFO] [lib.training.feature_preprocessing:77] Removed 4 features with zero variance
2025-12-16 03:47:36 [INFO] [lib.training.feature_preprocessing:141] Removed 423 collinear features (correlation >= 0.95)
2025-12-16 03:47:36 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 2005/2432 (82.4% retained)
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:667] Using 2005 features after collinearity removal
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-16 03:47:36 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 03:47:39 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 34 (out of 200)
2025-12-16 03:47:39 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 03:47:39 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 03:47:40 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 03:47:40 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 03:47:40 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 03:51:37 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (66, 2432)
2025-12-16 03:51:38 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 03:51:38 [INFO] [lib.training.pipeline:500] Fold 2 - Val Loss: 0.6479, Val Acc: 0.6212, Val F1: 0.7126, Val Precision: 0.5849, Val Recall: 0.9118
2025-12-16 03:51:38 [INFO] [lib.training.pipeline:505]   Class 0 - Precision: 0.7692, Recall: 0.3125, F1: 0.4444
2025-12-16 03:51:38 [INFO] [lib.training.pipeline:509]   Class 1 - Precision: 0.5849, Recall: 0.9118, F1: 0.7126
2025-12-16 03:51:38 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_2
2025-12-16 03:51:38 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_2
2025-12-16 03:51:39 [INFO] [lib.training.visualization:480] Generated fold 2 plots: ROC/PR curves and confusion matrix
2025-12-16 03:51:39 [INFO] [lib.training.pipeline:1918] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 3/5 (10.0% sample)
2025-12-16 03:51:39 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 3...
2025-12-16 03:51:39 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 03:51:39 [INFO] [lib.training._xgboost_pretrained:637] Processing 262 videos...
2025-12-16 03:51:39 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 03:51:40 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 03:51:40 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 03:51:41 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:06:48 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-16 04:06:48 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:06:48 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 04:06:48 [INFO] [lib.training.feature_preprocessing:77] Removed 4 features with zero variance
2025-12-16 04:06:49 [INFO] [lib.training.feature_preprocessing:141] Removed 436 collinear features (correlation >= 0.95)
2025-12-16 04:06:49 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1992/2432 (81.9% retained)
2025-12-16 04:06:49 [INFO] [lib.training._xgboost_pretrained:667] Using 1992 features after collinearity removal
2025-12-16 04:06:49 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-16 04:06:49 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-16 04:06:49 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 04:06:51 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 34 (out of 200)
2025-12-16 04:06:51 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 04:06:52 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:06:52 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:06:53 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:06:53 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:10:47 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-16 04:10:47 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:10:47 [INFO] [lib.training.pipeline:500] Fold 3 - Val Loss: 0.6403, Val Acc: 0.5231, Val F1: 0.6737, Val Precision: 0.5161, Val Recall: 0.9697
2025-12-16 04:10:47 [INFO] [lib.training.pipeline:505]   Class 0 - Precision: 0.6667, Recall: 0.0625, F1: 0.1143
2025-12-16 04:10:47 [INFO] [lib.training.pipeline:509]   Class 1 - Precision: 0.5161, Recall: 0.9697, F1: 0.6737
2025-12-16 04:10:47 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_3
2025-12-16 04:10:47 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_3
2025-12-16 04:10:48 [INFO] [lib.training.visualization:480] Generated fold 3 plots: ROC/PR curves and confusion matrix
2025-12-16 04:10:49 [INFO] [lib.training.pipeline:1918] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 4/5 (10.0% sample)
2025-12-16 04:10:49 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 4...
2025-12-16 04:10:49 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 04:10:49 [INFO] [lib.training._xgboost_pretrained:637] Processing 262 videos...
2025-12-16 04:10:49 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:10:49 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:10:50 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:10:50 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:26:07 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-16 04:26:08 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:26:08 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 04:26:08 [INFO] [lib.training.feature_preprocessing:77] Removed 12 features with zero variance
2025-12-16 04:26:09 [INFO] [lib.training.feature_preprocessing:141] Removed 447 collinear features (correlation >= 0.95)
2025-12-16 04:26:09 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1973/2432 (81.1% retained)
2025-12-16 04:26:09 [INFO] [lib.training._xgboost_pretrained:667] Using 1973 features after collinearity removal
2025-12-16 04:26:09 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-16 04:26:09 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-16 04:26:09 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 04:26:12 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 79 (out of 200)
2025-12-16 04:26:12 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 04:26:12 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:26:13 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:26:13 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:26:14 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:30:02 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-16 04:30:02 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:30:02 [INFO] [lib.training.pipeline:500] Fold 4 - Val Loss: 0.6619, Val Acc: 0.6308, Val F1: 0.7209, Val Precision: 0.5849, Val Recall: 0.9394
2025-12-16 04:30:02 [INFO] [lib.training.pipeline:505]   Class 0 - Precision: 0.8333, Recall: 0.3125, F1: 0.4545
2025-12-16 04:30:02 [INFO] [lib.training.pipeline:509]   Class 1 - Precision: 0.5849, Recall: 0.9394, F1: 0.7209
2025-12-16 04:30:02 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_4
2025-12-16 04:30:02 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_4
2025-12-16 04:30:04 [INFO] [lib.training.visualization:480] Generated fold 4 plots: ROC/PR curves and confusion matrix
2025-12-16 04:30:04 [INFO] [lib.training.pipeline:1918] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 5/5 (10.0% sample)
2025-12-16 04:30:04 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 5...
2025-12-16 04:30:04 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 04:30:04 [INFO] [lib.training._xgboost_pretrained:637] Processing 262 videos...
2025-12-16 04:30:04 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:30:05 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:30:05 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:30:05 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:45:18 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-16 04:45:18 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:45:18 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 04:45:18 [INFO] [lib.training.feature_preprocessing:77] Removed 11 features with zero variance
2025-12-16 04:45:19 [INFO] [lib.training.feature_preprocessing:141] Removed 440 collinear features (correlation >= 0.95)
2025-12-16 04:45:19 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1981/2432 (81.5% retained)
2025-12-16 04:45:19 [INFO] [lib.training._xgboost_pretrained:667] Using 1981 features after collinearity removal
2025-12-16 04:45:19 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-16 04:45:19 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-16 04:45:19 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 04:45:22 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 54 (out of 200)
2025-12-16 04:45:22 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 04:45:22 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:45:23 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:45:23 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:45:23 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 04:48:51 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-16 04:48:51 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 04:48:51 [INFO] [lib.training.pipeline:500] Fold 5 - Val Loss: 0.6498, Val Acc: 0.6923, Val F1: 0.6000, Val Precision: 0.8824, Val Recall: 0.4545
2025-12-16 04:48:51 [INFO] [lib.training.pipeline:505]   Class 0 - Precision: 0.6250, Recall: 0.9375, F1: 0.7500
2025-12-16 04:48:51 [INFO] [lib.training.pipeline:509]   Class 1 - Precision: 0.8824, Recall: 0.4545, F1: 0.6000
2025-12-16 04:48:51 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_5
2025-12-16 04:48:51 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_5
2025-12-16 04:48:53 [INFO] [lib.training.visualization:480] Generated fold 5 plots: ROC/PR curves and confusion matrix
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2079] Parameter combination 1 - Mean F1: 0.6815, Mean Acc: 0.6207
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2091] Using single parameter combination: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2094] ================================================================================
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2095] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2096] ================================================================================
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2109] Final training: Using 5-fold stratified cross-validation on full dataset (3277 rows)
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2117] Final training using best hyperparameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2123] 
Final Training - xgboost_pretrained_inception - Fold 1/5 (full dataset)
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:2131] Deleted existing final training fold 1 directory (clean mode)
2025-12-16 04:48:53 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 1...
2025-12-16 04:48:53 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 04:48:53 [INFO] [lib.training._xgboost_pretrained:637] Processing 2621 videos...
2025-12-16 04:48:53 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 04:48:54 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 04:48:54 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 04:48:54 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 07:21:23 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2621, 2432)
2025-12-16 07:21:23 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 07:21:24 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 07:21:24 [INFO] [lib.training.feature_preprocessing:77] Removed 3 features with zero variance
2025-12-16 07:21:25 [INFO] [lib.training.feature_preprocessing:141] Removed 433 collinear features (correlation >= 0.95)
2025-12-16 07:21:25 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1996/2432 (82.1% retained)
2025-12-16 07:21:25 [INFO] [lib.training._xgboost_pretrained:667] Using 1996 features after collinearity removal
2025-12-16 07:21:25 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=1284, Class 1=1337, scale_pos_weight=0.960
2025-12-16 07:21:25 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 2096 train samples, 525 validation samples for early stopping
2025-12-16 07:21:25 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 07:22:11 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 200 (out of 200)
2025-12-16 07:22:11 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 07:22:11 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 07:22:12 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 07:22:12 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 07:22:13 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 07:59:04 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (656, 2432)
2025-12-16 07:59:05 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 07:59:05 [INFO] [lib.training.pipeline:500] Fold 1 - Val Loss: 0.5782, Val Acc: 0.7104, Val F1: 0.7526, Val Precision: 0.6674, Val Recall: 0.8627
2025-12-16 07:59:05 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_1
2025-12-16 07:59:05 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_1
2025-12-16 07:59:06 [INFO] [lib.training.visualization:480] Generated fold 1 plots: ROC/PR curves and confusion matrix
2025-12-16 07:59:06 [INFO] [lib.training.pipeline:2123] 
Final Training - xgboost_pretrained_inception - Fold 2/5 (full dataset)
2025-12-16 07:59:06 [INFO] [lib.training.pipeline:2131] Deleted existing final training fold 2 directory (clean mode)
2025-12-16 07:59:06 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 2...
2025-12-16 07:59:06 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 07:59:06 [INFO] [lib.training._xgboost_pretrained:637] Processing 2621 videos...
2025-12-16 07:59:07 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 07:59:07 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 07:59:08 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 07:59:08 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 10:33:23 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2621, 2432)
2025-12-16 10:33:24 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 10:33:24 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 10:33:24 [INFO] [lib.training.feature_preprocessing:77] Removed 1 features with zero variance
2025-12-16 10:33:25 [INFO] [lib.training.feature_preprocessing:141] Removed 436 collinear features (correlation >= 0.95)
2025-12-16 10:33:25 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1995/2432 (82.0% retained)
2025-12-16 10:33:25 [INFO] [lib.training._xgboost_pretrained:667] Using 1995 features after collinearity removal
2025-12-16 10:33:25 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=1284, Class 1=1337, scale_pos_weight=0.960
2025-12-16 10:33:25 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 2096 train samples, 525 validation samples for early stopping
2025-12-16 10:33:25 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 10:34:11 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 200 (out of 200)
2025-12-16 10:34:11 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 10:34:12 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 10:34:13 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 10:34:13 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 10:34:13 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 11:13:47 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (656, 2432)
2025-12-16 11:13:48 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 11:13:48 [INFO] [lib.training.pipeline:500] Fold 2 - Val Loss: 0.5561, Val Acc: 0.7241, Val F1: 0.7740, Val Precision: 0.6652, Val Recall: 0.9254
2025-12-16 11:13:48 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_2
2025-12-16 11:13:48 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_2
2025-12-16 11:13:49 [INFO] [lib.training.visualization:480] Generated fold 2 plots: ROC/PR curves and confusion matrix
2025-12-16 11:13:50 [INFO] [lib.training.pipeline:2123] 
Final Training - xgboost_pretrained_inception - Fold 3/5 (full dataset)
2025-12-16 11:13:50 [INFO] [lib.training.pipeline:2131] Deleted existing final training fold 3 directory (clean mode)
2025-12-16 11:13:50 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 3...
2025-12-16 11:13:50 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 11:13:50 [INFO] [lib.training._xgboost_pretrained:637] Processing 2622 videos...
2025-12-16 11:13:50 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 11:13:50 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 11:13:51 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 11:13:51 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 13:49:09 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-16 13:49:09 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 13:49:09 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 13:49:10 [INFO] [lib.training.feature_preprocessing:77] Removed 3 features with zero variance
2025-12-16 13:49:10 [INFO] [lib.training.feature_preprocessing:141] Removed 431 collinear features (correlation >= 0.95)
2025-12-16 13:49:10 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1998/2432 (82.2% retained)
2025-12-16 13:49:10 [INFO] [lib.training._xgboost_pretrained:667] Using 1998 features after collinearity removal
2025-12-16 13:49:10 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-16 13:49:10 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-16 13:49:10 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 13:49:57 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 200 (out of 200)
2025-12-16 13:49:57 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 13:49:58 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 13:49:58 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 13:49:59 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 13:49:59 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 14:29:12 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-16 14:29:13 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 14:29:13 [INFO] [lib.training.pipeline:500] Fold 3 - Val Loss: 0.5372, Val Acc: 0.7725, Val F1: 0.7825, Val Precision: 0.7635, Val Recall: 0.8024
2025-12-16 14:29:13 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_3
2025-12-16 14:29:13 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_3
2025-12-16 14:29:14 [INFO] [lib.training.visualization:480] Generated fold 3 plots: ROC/PR curves and confusion matrix
2025-12-16 14:29:14 [INFO] [lib.training.pipeline:2123] 
Final Training - xgboost_pretrained_inception - Fold 4/5 (full dataset)
2025-12-16 14:29:14 [INFO] [lib.training.pipeline:2131] Deleted existing final training fold 4 directory (clean mode)
2025-12-16 14:29:14 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 4...
2025-12-16 14:29:14 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 14:29:14 [INFO] [lib.training._xgboost_pretrained:637] Processing 2622 videos...
2025-12-16 14:29:14 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 14:29:15 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 14:29:15 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 14:29:15 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 17:03:13 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-16 17:03:13 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 17:03:14 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 17:03:14 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-16 17:03:15 [INFO] [lib.training.feature_preprocessing:141] Removed 446 collinear features (correlation >= 0.95)
2025-12-16 17:03:15 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1986/2432 (81.7% retained)
2025-12-16 17:03:15 [INFO] [lib.training._xgboost_pretrained:667] Using 1986 features after collinearity removal
2025-12-16 17:03:15 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-16 17:03:15 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-16 17:03:15 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 17:04:01 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 200 (out of 200)
2025-12-16 17:04:01 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 17:04:02 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 17:04:02 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 17:04:02 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 17:04:03 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 17:43:49 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-16 17:43:50 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 17:43:50 [INFO] [lib.training.pipeline:500] Fold 4 - Val Loss: 0.6521, Val Acc: 0.5878, Val F1: 0.7115, Val Precision: 0.5532, Val Recall: 0.9970
2025-12-16 17:43:50 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_4
2025-12-16 17:43:50 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_4
2025-12-16 17:43:51 [INFO] [lib.training.visualization:480] Generated fold 4 plots: ROC/PR curves and confusion matrix
2025-12-16 17:43:52 [INFO] [lib.training.pipeline:2123] 
Final Training - xgboost_pretrained_inception - Fold 5/5 (full dataset)
2025-12-16 17:43:52 [INFO] [lib.training.pipeline:2131] Deleted existing final training fold 5 directory (clean mode)
2025-12-16 17:43:52 [INFO] [lib.training.pipeline:448] Training XGBoost model xgboost_pretrained_inception on fold 5...
2025-12-16 17:43:52 [INFO] [lib.training._xgboost_pretrained:636] Training XGBoost on features from pretrained_inception...
2025-12-16 17:43:52 [INFO] [lib.training._xgboost_pretrained:637] Processing 2622 videos...
2025-12-16 17:43:52 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 17:43:52 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 17:43:53 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 17:43:53 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 20:19:00 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-16 20:19:01 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 20:19:01 [INFO] [lib.training._xgboost_pretrained:660] Removing collinear features...
2025-12-16 20:19:01 [INFO] [lib.training.feature_preprocessing:77] Removed 1 features with zero variance
2025-12-16 20:19:02 [INFO] [lib.training.feature_preprocessing:141] Removed 436 collinear features (correlation >= 0.95)
2025-12-16 20:19:02 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1995/2432 (82.0% retained)
2025-12-16 20:19:02 [INFO] [lib.training._xgboost_pretrained:667] Using 1995 features after collinearity removal
2025-12-16 20:19:02 [INFO] [lib.training._xgboost_pretrained:683] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-16 20:19:02 [INFO] [lib.training._xgboost_pretrained:701] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-16 20:19:02 [INFO] [lib.training._xgboost_pretrained:704] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-16 20:19:48 [INFO] [lib.training._xgboost_pretrained:770] Early stopping: Best iteration = 200 (out of 200)
2025-12-16 20:19:48 [INFO] [lib.training._xgboost_pretrained:772] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-16 20:19:49 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-16 20:19:49 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-16 20:19:50 [INFO] [lib.training._xgboost_pretrained:604] Extracting features using pretrained_inception (num_frames=400)...
2025-12-16 20:19:50 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-16 20:58:01 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-16 20:58:01 [INFO] [lib.training._xgboost_pretrained:622] Cleared pretrained_inception model from GPU after feature extraction
2025-12-16 20:58:01 [INFO] [lib.training.pipeline:500] Fold 5 - Val Loss: 0.6279, Val Acc: 0.6137, Val F1: 0.7204, Val Precision: 0.5709, Val Recall: 0.9760
2025-12-16 20:58:01 [INFO] [lib.training._xgboost_pretrained:840] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_5
2025-12-16 20:58:01 [INFO] [lib.training.pipeline:516] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/fold_5
2025-12-16 20:58:03 [INFO] [lib.training.visualization:480] Generated fold 5 plots: ROC/PR curves and confusion matrix
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:107] Saved best model from fold 3: Copied 2 model file(s) from fold_3 to best_model
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:2348] 
xgboost_pretrained_inception - Avg Val Loss: 0.5903 ± 0.0433, Avg Val Acc: 0.6817 ± 0.0697, Avg Val F1: 0.7482 ± 0.0282
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:2352]   Avg Val Precision: 0.6441 ± 0.0760, Avg Val Recall: 0.9127 ± 0.0720
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:2356]   Class 0 - F1: 0.5423 ± 0.1834, Precision: 0.8662 ± 0.0733, Recall: 0.4411 ± 0.2132
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:2361]   Class 1 - F1: 0.7482 ± 0.0282, Precision: 0.6441 ± 0.0760, Recall: 0.9127 ± 0.0720
2025-12-16 20:58:03 [INFO] [lib.training.pipeline:2399] Saved aggregated metrics to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/metrics.json (model: xgboost_pretrained_inception)
2025-12-16 20:58:05 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/plots/cv_fold_comparison.png
2025-12-16 20:58:05 [INFO] [lib.training.pipeline:2426] Generated plots for xgboost_pretrained_inception in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_pretrained_inception/plots
2025-12-16 20:58:05 [INFO] [lib.training.pipeline:2463] ================================================================================
2025-12-16 20:58:05 [INFO] [lib.training.pipeline:2464] Stage 5: Model Training Pipeline Completed
2025-12-16 20:58:05 [INFO] [lib.training.pipeline:2465] ================================================================================
2025-12-16 20:58:05 [INFO] [__main__:401] ================================================================================
2025-12-16 20:58:05 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-16 20:58:05 [INFO] [__main__:403] ================================================================================
2025-12-16 20:58:05 [INFO] [__main__:404] Execution time: 63906.17 seconds (1065.10 minutes)
2025-12-16 20:58:05 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-16 20:58:05 [INFO] [__main__:407] Models trained: ['xgboost_pretrained_inception']
2025-12-16 20:58:05 [INFO] [__main__:408] K-fold splits: 5
2025-12-16 20:58:05 [INFO] [__main__:414] ================================================================================
2025-12-16 20:58:05 [INFO] [__main__:415] Final memory statistics:
2025-12-16 20:58:05 [INFO] [__main__:416] ================================================================================
2025-12-16 20:58:05 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 12359.515625, 'cpu_memory_gb': 12.069839477539062, 'cpu_vms_mb': 41456.55078125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-16 20:58:05 [INFO] [__main__:419] ================================================================================
2025-12-16 20:58:05 [INFO] [__main__:420] Training complete!
2025-12-16 20:58:05 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-16 20:58:05 [INFO] [__main__:422] ================================================================================
