2025-12-17 19:37:14 [INFO] [__main__:310] ================================================================================
2025-12-17 19:37:14 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-17 19:37:14 [INFO] [__main__:312] ================================================================================
2025-12-17 19:37:14 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-17 19:37:14 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-17 19:37:14 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:14 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-17 19:37:14 [INFO] [__main__:317] Model types: ['logistic_regression']
2025-12-17 19:37:14 [INFO] [__main__:318] K-fold splits: 5
2025-12-17 19:37:14 [INFO] [__main__:319] Number of frames: 1000
2025-12-17 19:37:14 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-17 19:37:14 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-17 19:37:14 [INFO] [__main__:324] Delete existing: True
2025-12-17 19:37:14 [INFO] [__main__:325] Resume mode: True
2025-12-17 19:37:14 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1766018234.log
2025-12-17 19:37:14 [INFO] [__main__:333] ================================================================================
2025-12-17 19:37:14 [INFO] [__main__:334] Checking prerequisites...
2025-12-17 19:37:14 [INFO] [__main__:335] ================================================================================
2025-12-17 19:37:14 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-17 19:37:14 [INFO] [__main__:352] ✓ All model types are valid
2025-12-17 19:37:14 [INFO] [__main__:358] ================================================================================
2025-12-17 19:37:14 [INFO] [__main__:359] Initial memory statistics:
2025-12-17 19:37:14 [INFO] [__main__:360] ================================================================================
2025-12-17 19:37:15 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 755.9921875, 'cpu_memory_gb': 0.7382736206054688, 'cpu_vms_mb': 10632.24609375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-17 19:37:15 [INFO] [__main__:364] ================================================================================
2025-12-17 19:37:15 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-17 19:37:15 [INFO] [__main__:366] ================================================================================
2025-12-17 19:37:15 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-17 19:37:15 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-17 19:37:15 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-17 19:37:15 [INFO] [__main__:370] ================================================================================
2025-12-17 19:37:15 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-17 19:37:15 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1547] Applied global PyTorch memory optimizations at pipeline start
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1550] ================================================================================
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1551] Stage 5: Model Training Pipeline Started
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1552] ================================================================================
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1553] Model types: ['logistic_regression']
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1554] K-fold splits: 5
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1555] Frames per video: 1000
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1556] Output directory: data/stage5
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:1557] Initializing pipeline...
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:254] ================================================================================
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:255] STAGE 5 PREREQUISITE VALIDATION
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:256] ================================================================================
2025-12-17 19:37:15 [INFO] [lib.training.pipeline:258] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:267] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:268]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:270] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:278] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:279]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:281] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:289] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:290]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:292] 
================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:293] MODEL REQUIREMENTS CHECK
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:294] ================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:313] ✓ logistic_regression: CAN RUN
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:315] 
================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:316] VALIDATION SUMMARY
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:317] ================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:318] Stage 3 (scaled videos): ✓ Available
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:319]   Count: 3278 videos
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:320] Stage 2 (features): ✓ Available
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:321]   Count: 3278 feature rows
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:322] Stage 4 (scaled features): ✓ Available
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:323]   Count: 3277 feature rows
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:324] 
Runnable models: 1/1
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:325]   ['logistic_regression']
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:332] ================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1638] 
Stage 5: Loading metadata...
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1662] Loaded metadata: 3278 rows
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1672] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-17 19:37:16 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=753589.19GB, used=1746250.81GB (69.9%)
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1693] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1703] Stage 5: Found 3278 scaled videos
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1706] ================================================================================
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1707] STAGE 5: VALIDATING VIDEOS (checking for corruption and empty videos)
2025-12-17 19:37:16 [INFO] [lib.training.pipeline:1708] ================================================================================
2025-12-17 19:37:16 [INFO] [lib.data.loading:156] Checking file existence for 3278 videos...
2025-12-17 19:37:26 [INFO] [lib.data.loading:166] Found 3278 existing video files (filtered out 0 missing files)
2025-12-17 19:37:26 [INFO] [lib.data.loading:170] Checking for corrupted videos (moov atom errors, etc.)...
2025-12-17 19:37:30 [INFO] [lib.data.loading:92] Loaded validation cache from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/.video_validation_cache/validation_0192be168a40eb7e_corruptTrue_framesTrue.parquet (3278 entries)
2025-12-17 19:37:30 [INFO] [lib.data.loading:194] Cache hit: 3278 videos, Cache miss: 0 videos
2025-12-17 19:37:31 [WARNING] [lib.data.loading:306] Filtered out 1 corrupted videos and 0 empty videos. Keeping 3277 valid videos.
2025-12-17 19:37:31 [WARNING] [lib.data.loading:311] Sample of invalid videos:
2025-12-17 19:37:31 [WARNING] [lib.data.loading:313]   data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: Corrupted video: moov atom not found
2025-12-17 19:37:31 [INFO] [lib.data.loading:323] Found /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/skip_frame_check.txt - skipping frame check as requested.
2025-12-17 19:37:31 [WARNING] [lib.data.loading:387] Filtered out 1 invalid videos (corrupted). Keeping 3277 valid videos.
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1717] ✓ Video validation complete: 3277 valid videos ready for training
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1718] ================================================================================
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1804] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1905] Stage 5: Deleting existing model results (clean mode)...
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1913] Deleted existing results for logistic_regression
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1916] Stage 5: Deleted 1 existing model directories
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1920] 
================================================================================
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1921] Stage 5: Training model: logistic_regression
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1922] ================================================================================
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1958] Grid search: 6 hyperparameter combinations to try
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1966] ================================================================================
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1967] HYPERPARAMETER SEARCH: Using 10.0% stratified sample for efficiency
2025-12-17 19:37:31 [INFO] [lib.training.pipeline:1968] ================================================================================
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1977] Hyperparameter search sample: 327 rows (10.0% of 3277 total)
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1978] To change sample size, set FVC_GRID_SEARCH_SAMPLE_SIZE environment variable (current: 0.1)
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1990] Using 5-fold stratified cross-validation on 10.0% sample for hyperparameter search
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 1/6
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 0.1, 'max_iter': 1000}
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:37:32 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:37:32 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:32 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:32 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:32 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:32 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:32 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:32 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:37:34 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:37:34 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:34 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:37:34 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:34 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:34 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:34 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:37:34 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:37:34 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:34 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:37:34 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:37:36 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:36 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:37:36 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:37:36 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:37:36 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:37:36 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:37:36 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:36 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:37:36 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:37:36 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:37:36 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:37 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:37:37 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:37:37 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:37:37 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:37:37 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:37 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:37 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:37 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:37 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:37 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:37 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:37:40 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:40 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:37:40 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:40 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:40 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:40 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:37:40 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:37:40 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:40 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:37:40 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:37:40 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:40 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:37:40 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:37:40 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:37:40 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:37:40 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:37:40 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:40 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:37:40 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:37:40 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:37:40 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:41 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:37:41 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:37:41 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:37:41 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:37:41 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:41 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:41 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:41 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:41 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:41 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:41 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:37:43 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:43 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:37:43 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:43 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:43 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:43 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:37:43 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:37:43 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:43 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:37:43 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:37:43 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:43 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:43 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:37:43 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:37:43 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:37:43 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:43 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:37:44 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:37:44 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:37:44 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:44 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:37:44 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:37:44 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:37:44 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:37:44 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:44 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:44 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:44 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:44 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:37:47 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:47 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:37:47 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:47 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:47 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:47 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:37:47 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:37:47 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:47 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:37:47 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:37:47 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:47 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:47 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:37:47 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:37:47 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:37:47 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:47 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:37:48 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:37:48 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:37:48 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:48 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:37:48 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:37:48 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:37:48 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:37:48 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:48 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:48 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:48 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:48 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:37:51 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:51 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:37:51 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:51 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:51 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:37:51 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:37:51 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:37:51 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:51 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:37:51 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:37:51 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:51 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:51 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:37:51 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:37:51 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:37:51 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:51 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:37:52 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:37:52 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:37:52 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:52 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:37:52 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:37:52 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2183] Parameter combination 1 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 2/6
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 0.1, 'max_iter': 2000}
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:37:52 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:37:52 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:52 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:52 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:52 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:52 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:37:55 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:55 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:37:55 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:55 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:55 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:55 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:37:55 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:37:55 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:55 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:37:55 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:37:55 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:55 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:37:55 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:37:55 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:37:55 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:37:55 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:37:55 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:55 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:37:55 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:37:55 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:37:55 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:37:56 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:37:56 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-17 19:37:56 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:37:56 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:37:56 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:37:56 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:37:56 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:37:56 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:56 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:37:56 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:56 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:56 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:37:58 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:37:58 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:37:58 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:37:58 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:37:58 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:37:58 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:37:58 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:37:58 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:37:58 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:37:58 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:37:58 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:37:58 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:37:58 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:37:58 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:37:58 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:37:58 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:37:58 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:37:59 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:37:59 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:37:59 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:37:59 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:37:59 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:37:59 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:37:59 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:37:59 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:37:59 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:37:59 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:37:59 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:37:59 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:00 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:38:00 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-17 19:38:00 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:38:00 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:38:00 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:00 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:00 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:00 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:00 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:00 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:00 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:00 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:02 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:02 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:02 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:02 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:02 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:02 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:38:02 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:02 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:02 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:02 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:02 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:02 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:02 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:38:02 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:38:02 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:02 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:02 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:03 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:03 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:03 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:03 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:38:03 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:03 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:38:03 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:03 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:03 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:03 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:03 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:03 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:06 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:06 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:06 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:06 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:06 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:06 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:38:06 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:06 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:06 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:06 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:06 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:06 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:06 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:38:06 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:38:06 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:06 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:06 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:07 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:07 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:07 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:07 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:38:07 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:07 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:38:07 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:07 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:07 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:07 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:07 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:07 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:10 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:10 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:10 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:10 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:10 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:10 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:38:10 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:10 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:10 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:10 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:10 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:10 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:10 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:10 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:10 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:10 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:10 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:10 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:38:10 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:10 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:10 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2183] Parameter combination 2 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 3/6
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 1.0, 'max_iter': 1000}
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:38:11 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:11 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:11 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:11 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:11 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:11 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:11 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:11 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:13 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:13 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:13 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:13 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:13 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:13 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:38:13 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:13 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:13 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:13 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:13 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:13 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:13 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:38:13 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:38:13 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:13 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:13 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:14 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:14 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:14 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:14 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:14 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:14 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:38:14 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:38:14 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:38:14 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:38:14 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:14 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:14 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:15 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:38:15 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-17 19:38:15 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:38:15 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:38:15 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:15 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:15 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:15 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:15 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:15 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:15 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:15 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:17 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:17 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:17 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:17 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:17 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:17 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:38:17 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:17 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:17 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:17 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:17 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:17 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:17 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:38:17 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:38:17 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:17 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:17 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:18 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:18 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:18 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:18 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:38:18 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:18 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:38:18 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:18 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:18 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:18 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:18 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:18 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:21 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:21 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:21 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:21 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:21 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:21 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:38:21 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:21 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:21 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:21 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:21 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:21 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:21 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:38:21 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:38:21 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:21 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:21 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:22 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:22 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:22 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:22 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:38:22 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:22 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:38:22 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:22 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:22 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:22 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:22 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:22 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:25 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:25 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:25 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:25 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:25 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:25 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:38:25 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:25 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:25 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:25 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:25 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:25 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:25 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:25 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:25 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:25 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:25 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:25 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:38:25 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:25 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:25 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:26 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:38:26 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-17 19:38:26 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:38:26 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:38:26 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:26 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:26 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:26 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:26 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:26 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:26 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:26 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:28 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:28 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:28 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:28 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:28 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:28 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:38:28 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:28 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:28 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:28 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:28 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:28 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:28 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:38:28 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:38:28 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:28 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:28 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:29 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:29 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:29 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:29 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:29 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:29 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:38:29 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:38:29 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:38:29 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:38:29 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:29 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:29 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2183] Parameter combination 3 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 4/6
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 1.0, 'max_iter': 2000}
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:38:30 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:30 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:30 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:30 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:30 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:30 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:30 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:30 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:32 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:32 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:32 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:32 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:32 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:32 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:38:32 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:32 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:32 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:32 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:32 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:32 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:32 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:38:32 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:38:32 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:32 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:32 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:33 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:33 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:33 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:33 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:38:33 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:33 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:38:33 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:33 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:33 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:33 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:33 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:33 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:36 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:36 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:36 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:36 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:36 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:36 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:38:36 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:36 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:36 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:36 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:36 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:36 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:36 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:38:36 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:38:36 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:36 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:36 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:37 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:37 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:37 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:37 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:38:37 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:37 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:38:37 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:37 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:37 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:37 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:37 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:37 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:40 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:40 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:40 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:40 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:40 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:40 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:38:40 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:40 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:40 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:40 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:40 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:40 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:40 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:40 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:40 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:40 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:40 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:40 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:38:40 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:40 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:40 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:41 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:38:41 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-17 19:38:41 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:38:41 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:38:41 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:41 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:41 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:41 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:41 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:41 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:41 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:41 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:43 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:43 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:43 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:43 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:43 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:43 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:38:43 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:43 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:43 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:43 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:43 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:43 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:43 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:38:43 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:38:43 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:43 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:43 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:44 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:44 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:44 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:44 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:44 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:44 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:38:44 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:38:44 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:38:44 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:38:44 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:44 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:38:44 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:45 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:38:45 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-17 19:38:45 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:38:45 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:38:45 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:45 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:45 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:45 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:45 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:45 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:45 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:45 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:47 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:47 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:47 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:47 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:47 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:47 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:38:47 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:47 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:47 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:47 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:47 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:47 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:47 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:38:47 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:38:47 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:47 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:47 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:48 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:48 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:48 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:48 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:38:48 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:38:48 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2183] Parameter combination 4 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 5/6
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 10.0, 'max_iter': 1000}
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:38:48 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:48 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:48 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:48 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:48 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:48 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:51 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:51 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:51 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:51 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:51 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:51 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:38:51 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:51 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:51 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:51 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:51 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:51 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:51 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:38:51 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:38:51 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:51 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:51 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:52 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:52 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:52 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:52 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:38:52 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:38:52 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:38:52 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:38:52 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:52 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:52 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:52 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:52 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:38:55 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:55 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:38:55 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:55 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:55 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:38:55 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:38:55 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:38:55 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:55 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:38:55 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:38:55 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:55 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:38:55 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:38:55 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:38:55 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:38:55 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:38:55 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:55 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:38:55 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:55 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:38:55 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:56 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:38:56 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-17 19:38:56 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:38:56 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:38:56 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:56 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:56 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:56 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:56 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:56 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:56 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:56 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:38:58 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:38:58 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:38:58 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:38:58 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:38:58 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:38:58 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:38:58 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:38:58 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:38:58 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:38:58 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:38:58 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:38:58 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:38:58 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:38:58 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:38:58 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:38:58 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:58 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:38:59 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:38:59 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:38:59 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:38:59 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:38:59 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:38:59 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:38:59 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:38:59 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:38:59 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:38:59 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:59 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:38:59 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:39:02 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:02 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:39:02 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:02 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:02 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:02 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:39:02 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:39:02 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:02 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:39:02 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:39:02 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:02 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:02 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:39:02 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:39:02 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:39:02 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:02 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:39:03 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:39:03 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:39:03 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:03 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:39:03 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:39:03 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:39:03 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:39:03 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:03 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:03 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:03 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:03 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:39:06 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:06 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:39:06 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:06 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:06 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:06 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:39:06 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:39:06 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:06 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:39:06 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:39:06 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:06 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:06 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:39:06 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:39:06 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:39:06 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:06 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:39:07 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:39:07 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:39:07 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:07 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:39:07 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:39:07 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2183] Parameter combination 5 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2001] 
================================================================================
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2002] Grid Search: Hyperparameter combination 6/6
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2003] Parameters: {'C': 10.0, 'max_iter': 2000}
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2004] ================================================================================
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 1/5 (10.0% sample)
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:39:07 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:39:07 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:07 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:07 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:07 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:07 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:39:10 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:10 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:39:10 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:10 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:10 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:39:10 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31640956.5858
2025-12-17 19:39:10 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:39:10 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:10 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:39:10 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:39:10 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:10 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:39:10 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:39:10 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:39:10 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:39:10 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:39:10 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:10 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6512, Val Acc: 0.6667, Val F1: 0.6944, Val Precision: 0.6579, Val Recall: 0.7353
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6786, Recall: 0.5938, F1: 0.6333
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6579, Recall: 0.7353, F1: 0.6944
2025-12-17 19:39:10 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:39:10 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:39:10 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:11 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 2/5 (10.0% sample)
2025-12-17 19:39:11 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-17 19:39:11 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:39:11 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:39:11 [INFO] [lib.training.pipeline:1331] Training data: 261 rows
2025-12-17 19:39:11 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:11 [INFO] [lib.training._linear:135] Loading features for 261 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:11 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:11 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:11 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:11 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:11 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (261, 15), dtype: float64
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (261/261 videos matched)
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(261, 15)]
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 261 videos with features
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 261 videos with valid features
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:537] All 261 videos have valid features
2025-12-17 19:39:13 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:13 [INFO] [lib.training._linear:156] Feature matrix shape: (261, 15)
2025-12-17 19:39:13 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:13 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:13 [INFO] [lib.training._linear:211] Feature matrix shape: (261, 15), dtype: float64
2025-12-17 19:39:13 [INFO] [lib.training._linear:212] Feature stats: min=-0.2001, max=5173548124.1600, mean=29989797.6859
2025-12-17 19:39:13 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (261, 15)
2025-12-17 19:39:13 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:13 [INFO] [lib.training._linear:244] Training samples: 261, Features: 15
2025-12-17 19:39:13 [INFO] [lib.training._linear:245] Label distribution: [128 133]
2025-12-17 19:39:13 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:13 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:13 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:39:13 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:39:13 [INFO] [lib.training.pipeline:1351] Validation data: 66 rows
2025-12-17 19:39:13 [INFO] [lib.training._linear:312] Loading features for prediction (66 videos)...
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:13 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (66, 15), dtype: float64
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (66/66 videos matched)
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(66, 15)]
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (66, 15), dtype: float64
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 66 videos with features
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 66 videos with valid features
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:537] All 66 videos have valid features
2025-12-17 19:39:14 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (66, 15))
2025-12-17 19:39:14 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (66, 15))...
2025-12-17 19:39:14 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:14 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (66, 2))
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6805, Val Acc: 0.5909, Val F1: 0.5714, Val Precision: 0.6207, Val Recall: 0.5294
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.5676, Recall: 0.6562, F1: 0.6087
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6207, Recall: 0.5294, F1: 0.5714
2025-12-17 19:39:14 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:39:14 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 3/5 (10.0% sample)
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:39:14 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:39:14 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:14 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:14 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:14 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:14 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:39:17 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:17 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:39:17 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:17 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:17 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:17 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=32124187.1520
2025-12-17 19:39:17 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:39:17 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:17 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:39:17 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:39:17 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:17 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:17 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:39:17 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:39:17 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:39:17 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:17 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:39:18 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:39:18 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:39:18 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:18 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6255, Val Acc: 0.6154, Val F1: 0.6575, Val Precision: 0.6000, Val Recall: 0.7273
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6400, Recall: 0.5000, F1: 0.5614
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6000, Recall: 0.7273, F1: 0.6575
2025-12-17 19:39:18 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:39:18 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 4/5 (10.0% sample)
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:39:18 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:39:18 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:18 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:18 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:18 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:18 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:39:21 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:21 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:39:21 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:21 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:21 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:21 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31391883.2813
2025-12-17 19:39:21 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:39:21 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:21 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:39:21 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:39:21 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:21 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:39:21 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:39:21 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:39:21 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:39:21 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:39:21 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:21 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6400, Val Acc: 0.6462, Val F1: 0.6667, Val Precision: 0.6389, Val Recall: 0.6970
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6552, Recall: 0.5938, F1: 0.6230
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6389, Recall: 0.6970, F1: 0.6667
2025-12-17 19:39:21 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:39:21 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:39:21 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:22 [INFO] [lib.training.pipeline:2022] 
Hyperparameter Search - logistic_regression - Fold 5/5 (10.0% sample)
2025-12-17 19:39:22 [INFO] [lib.training.pipeline:2030] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-17 19:39:22 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:39:22 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:39:22 [INFO] [lib.training.pipeline:1331] Training data: 262 rows
2025-12-17 19:39:22 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:22 [INFO] [lib.training._linear:135] Loading features for 262 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:22 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:22 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:22 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:22 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:22 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (262, 15), dtype: float64
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (262/262 videos matched)
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(262, 15)]
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.03 MB
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 262 videos with features
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 262 videos with valid features
2025-12-17 19:39:24 [INFO] [lib.training.feature_preprocessing:537] All 262 videos have valid features
2025-12-17 19:39:25 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:25 [INFO] [lib.training._linear:156] Feature matrix shape: (262, 15)
2025-12-17 19:39:25 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:25 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:25 [INFO] [lib.training._linear:211] Feature matrix shape: (262, 15), dtype: float64
2025-12-17 19:39:25 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=3597603637.7600, mean=28380676.2448
2025-12-17 19:39:25 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (262, 15)
2025-12-17 19:39:25 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:25 [INFO] [lib.training._linear:244] Training samples: 262, Features: 15
2025-12-17 19:39:25 [INFO] [lib.training._linear:245] Label distribution: [128 134]
2025-12-17 19:39:25 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:25 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1351] Validation data: 65 rows
2025-12-17 19:39:25 [INFO] [lib.training._linear:312] Loading features for prediction (65 videos)...
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (65, 15), dtype: float64
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (65/65 videos matched)
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(65, 15)]
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (65, 15), dtype: float64
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.01 MB
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 65 videos with features
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 65 videos with valid features
2025-12-17 19:39:25 [INFO] [lib.training.feature_preprocessing:537] All 65 videos have valid features
2025-12-17 19:39:25 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (65, 15))
2025-12-17 19:39:25 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (65, 15))...
2025-12-17 19:39:25 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:25 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (65, 2))
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6628, Val Acc: 0.6308, Val F1: 0.6667, Val Precision: 0.6154, Val Recall: 0.7273
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1408]   Class 0 - Precision: 0.6538, Recall: 0.5312, F1: 0.5862
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1412]   Class 1 - Precision: 0.6154, Recall: 0.7273, F1: 0.6667
2025-12-17 19:39:25 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:39:25 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:39:25 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2183] Parameter combination 6 - Mean F1: 0.6513, Mean Acc: 0.6300
2025-12-17 19:39:26 [INFO] [lib.training.grid_search:266] Best hyperparameters (mean F1: 0.6513): {'C': 0.1, 'max_iter': 1000}
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2190] Best hyperparameters selected from 10.0% sample: {'C': 0.1, 'max_iter': 1000}
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2198] ================================================================================
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2199] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2200] ================================================================================
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2213] Final training: Using 5-fold stratified cross-validation on full dataset (3277 rows)
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2221] Final training using best hyperparameters: {'C': 0.1, 'max_iter': 1000}
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2227] 
Final Training - logistic_regression - Fold 1/5 (full dataset)
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:2235] Deleted existing final training fold 1 directory (clean mode)
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 1...
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 1...
2025-12-17 19:39:26 [INFO] [lib.training.pipeline:1331] Training data: 2621 rows
2025-12-17 19:39:26 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:26 [INFO] [lib.training._linear:135] Loading features for 2621 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:26 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:26 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:26 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:26 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:26 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (2621, 15), dtype: float64
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (2621/2621 videos matched)
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(2621, 15)]
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (2621, 15), dtype: float64
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.30 MB
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 2621 videos with features
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 2621 videos with valid features
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:537] All 2621 videos have valid features
2025-12-17 19:39:52 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:39:52 [INFO] [lib.training._linear:156] Feature matrix shape: (2621, 15)
2025-12-17 19:39:52 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:39:52 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:39:52 [INFO] [lib.training._linear:211] Feature matrix shape: (2621, 15), dtype: float64
2025-12-17 19:39:52 [INFO] [lib.training._linear:212] Feature stats: min=-0.8231, max=5173548124.1600, mean=31711804.9660
2025-12-17 19:39:52 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (2621, 15)
2025-12-17 19:39:52 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:39:52 [INFO] [lib.training._linear:244] Training samples: 2621, Features: 15
2025-12-17 19:39:52 [INFO] [lib.training._linear:245] Label distribution: [1284 1337]
2025-12-17 19:39:52 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:39:52 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:39:52 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 1
2025-12-17 19:39:52 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 1...
2025-12-17 19:39:52 [INFO] [lib.training.pipeline:1351] Validation data: 656 rows
2025-12-17 19:39:52 [INFO] [lib.training._linear:312] Loading features for prediction (656 videos)...
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:52 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (656, 15), dtype: float64
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (656/656 videos matched)
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(656, 15)]
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (656, 15), dtype: float64
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.08 MB
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 656 videos with features
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 656 videos with valid features
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:537] All 656 videos have valid features
2025-12-17 19:39:59 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (656, 15))
2025-12-17 19:39:59 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (656, 15))...
2025-12-17 19:39:59 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:39:59 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (656, 2))
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 1
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1403] Fold 1 - Val Loss: 0.6296, Val Acc: 0.6326, Val F1: 0.6629, Val Precision: 0.6237, Val Recall: 0.7075
2025-12-17 19:39:59 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-17 19:39:59 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 1: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:2227] 
Final Training - logistic_regression - Fold 2/5 (full dataset)
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:2235] Deleted existing final training fold 2 directory (clean mode)
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 2...
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 2...
2025-12-17 19:39:59 [INFO] [lib.training.pipeline:1331] Training data: 2621 rows
2025-12-17 19:39:59 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:39:59 [INFO] [lib.training._linear:135] Loading features for 2621 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:39:59 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:59 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:39:59 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (2621, 15), dtype: float64
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (2621/2621 videos matched)
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(2621, 15)]
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (2621, 15), dtype: float64
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.30 MB
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 2621 videos with features
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 2621 videos with valid features
2025-12-17 19:40:25 [INFO] [lib.training.feature_preprocessing:537] All 2621 videos have valid features
2025-12-17 19:40:25 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:40:25 [INFO] [lib.training._linear:156] Feature matrix shape: (2621, 15)
2025-12-17 19:40:25 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:40:25 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:40:25 [INFO] [lib.training._linear:211] Feature matrix shape: (2621, 15), dtype: float64
2025-12-17 19:40:25 [INFO] [lib.training._linear:212] Feature stats: min=-0.8231, max=5060003115.5200, mean=31276454.7608
2025-12-17 19:40:25 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (2621, 15)
2025-12-17 19:40:25 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:40:25 [INFO] [lib.training._linear:244] Training samples: 2621, Features: 15
2025-12-17 19:40:25 [INFO] [lib.training._linear:245] Label distribution: [1284 1337]
2025-12-17 19:40:26 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:40:26 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:40:26 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 2
2025-12-17 19:40:26 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 2...
2025-12-17 19:40:26 [INFO] [lib.training.pipeline:1351] Validation data: 656 rows
2025-12-17 19:40:26 [INFO] [lib.training._linear:312] Loading features for prediction (656 videos)...
2025-12-17 19:40:26 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:40:26 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:40:26 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (656, 15), dtype: float64
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (656/656 videos matched)
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(656, 15)]
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (656, 15), dtype: float64
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.08 MB
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 656 videos with features
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 656 videos with valid features
2025-12-17 19:40:32 [INFO] [lib.training.feature_preprocessing:537] All 656 videos have valid features
2025-12-17 19:40:32 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (656, 15))
2025-12-17 19:40:32 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (656, 15))...
2025-12-17 19:40:32 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:40:32 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (656, 2))
2025-12-17 19:40:32 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 2
2025-12-17 19:40:32 [INFO] [lib.training.pipeline:1403] Fold 2 - Val Loss: 0.6656, Val Acc: 0.5732, Val F1: 0.5977, Val Precision: 0.5762, Val Recall: 0.6209
2025-12-17 19:40:32 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:40:32 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_2
2025-12-17 19:40:32 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 2: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:40:33 [INFO] [lib.training.pipeline:2227] 
Final Training - logistic_regression - Fold 3/5 (full dataset)
2025-12-17 19:40:33 [INFO] [lib.training.pipeline:2235] Deleted existing final training fold 3 directory (clean mode)
2025-12-17 19:40:33 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 3...
2025-12-17 19:40:33 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 3...
2025-12-17 19:40:33 [INFO] [lib.training.pipeline:1331] Training data: 2622 rows
2025-12-17 19:40:33 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:40:33 [INFO] [lib.training._linear:135] Loading features for 2622 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:40:33 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:40:33 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:40:33 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:40:33 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:40:33 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (2622, 15), dtype: float64
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (2622/2622 videos matched)
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(2622, 15)]
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.30 MB
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 2622 videos with features
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 2622 videos with valid features
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:537] All 2622 videos have valid features
2025-12-17 19:40:59 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:40:59 [INFO] [lib.training._linear:156] Feature matrix shape: (2622, 15)
2025-12-17 19:40:59 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:40:59 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:40:59 [INFO] [lib.training._linear:211] Feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:40:59 [INFO] [lib.training._linear:212] Feature stats: min=-0.8231, max=5173548124.1600, mean=31777325.2331
2025-12-17 19:40:59 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (2622, 15)
2025-12-17 19:40:59 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:40:59 [INFO] [lib.training._linear:244] Training samples: 2622, Features: 15
2025-12-17 19:40:59 [INFO] [lib.training._linear:245] Label distribution: [1284 1338]
2025-12-17 19:40:59 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:40:59 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:40:59 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 3
2025-12-17 19:40:59 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 3...
2025-12-17 19:40:59 [INFO] [lib.training.pipeline:1351] Validation data: 655 rows
2025-12-17 19:40:59 [INFO] [lib.training._linear:312] Loading features for prediction (655 videos)...
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:40:59 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (655, 15), dtype: float64
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (655/655 videos matched)
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(655, 15)]
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (655, 15), dtype: float64
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.07 MB
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 655 videos with features
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 655 videos with valid features
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:537] All 655 videos have valid features
2025-12-17 19:41:06 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (655, 15))
2025-12-17 19:41:06 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (655, 15))...
2025-12-17 19:41:06 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:41:06 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (655, 2))
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 3
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1403] Fold 3 - Val Loss: 0.6629, Val Acc: 0.5802, Val F1: 0.6066, Val Precision: 0.5808, Val Recall: 0.6347
2025-12-17 19:41:06 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_3
2025-12-17 19:41:06 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 3: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:2227] 
Final Training - logistic_regression - Fold 4/5 (full dataset)
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:2235] Deleted existing final training fold 4 directory (clean mode)
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 4...
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 4...
2025-12-17 19:41:06 [INFO] [lib.training.pipeline:1331] Training data: 2622 rows
2025-12-17 19:41:06 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:41:06 [INFO] [lib.training._linear:135] Loading features for 2622 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:41:06 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:41:06 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:41:06 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (2622, 15), dtype: float64
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (2622/2622 videos matched)
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(2622, 15)]
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.30 MB
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 2622 videos with features
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 2622 videos with valid features
2025-12-17 19:41:32 [INFO] [lib.training.feature_preprocessing:537] All 2622 videos have valid features
2025-12-17 19:41:32 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:41:32 [INFO] [lib.training._linear:156] Feature matrix shape: (2622, 15)
2025-12-17 19:41:32 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:41:32 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:41:32 [INFO] [lib.training._linear:211] Feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:41:32 [INFO] [lib.training._linear:212] Feature stats: min=-0.8228, max=5173548124.1600, mean=31675007.4833
2025-12-17 19:41:32 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (2622, 15)
2025-12-17 19:41:32 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:41:32 [INFO] [lib.training._linear:244] Training samples: 2622, Features: 15
2025-12-17 19:41:32 [INFO] [lib.training._linear:245] Label distribution: [1284 1338]
2025-12-17 19:41:33 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:41:33 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:41:33 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 4
2025-12-17 19:41:33 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 4...
2025-12-17 19:41:33 [INFO] [lib.training.pipeline:1351] Validation data: 655 rows
2025-12-17 19:41:33 [INFO] [lib.training._linear:312] Loading features for prediction (655 videos)...
2025-12-17 19:41:33 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:41:33 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:41:33 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (655, 15), dtype: float64
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (655/655 videos matched)
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(655, 15)]
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (655, 15), dtype: float64
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.07 MB
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 655 videos with features
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 655 videos with valid features
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:537] All 655 videos have valid features
2025-12-17 19:41:40 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (655, 15))
2025-12-17 19:41:40 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (655, 15))...
2025-12-17 19:41:40 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:41:40 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (655, 2))
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 4
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1403] Fold 4 - Val Loss: 0.6589, Val Acc: 0.5908, Val F1: 0.6059, Val Precision: 0.5954, Val Recall: 0.6168
2025-12-17 19:41:40 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_4
2025-12-17 19:41:40 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 4: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:2227] 
Final Training - logistic_regression - Fold 5/5 (full dataset)
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:2235] Deleted existing final training fold 5 directory (clean mode)
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1269] Training baseline model logistic_regression on fold 5...
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1330] Starting model.fit() for logistic_regression fold 5...
2025-12-17 19:41:40 [INFO] [lib.training.pipeline:1331] Training data: 2622 rows
2025-12-17 19:41:40 [INFO] [lib.training._linear:112] Using Stage 2 features from: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow (3278 rows)
2025-12-17 19:41:40 [INFO] [lib.training._linear:135] Loading features for 2622 videos (Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, Stage 4: not used)...
2025-12-17 19:41:40 [INFO] [lib.training._linear:139] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:41:40 [INFO] [lib.training._linear:140] Stage 4 path: not used
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:41:40 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (2622, 15), dtype: float64
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (2622/2622 videos matched)
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(2622, 15)]
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.30 MB
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 2622 videos with features
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 2622 videos with valid features
2025-12-17 19:42:06 [INFO] [lib.training.feature_preprocessing:537] All 2622 videos have valid features
2025-12-17 19:42:06 [INFO] [lib.training._linear:155] ✓ Loaded 15 features (collinearity already removed)
2025-12-17 19:42:06 [INFO] [lib.training._linear:156] Feature matrix shape: (2622, 15)
2025-12-17 19:42:06 [INFO] [lib.training._linear:197] Using 15 features after collinearity removal
2025-12-17 19:42:06 [INFO] [lib.training._linear:210] Scaling features...
2025-12-17 19:42:06 [INFO] [lib.training._linear:211] Feature matrix shape: (2622, 15), dtype: float64
2025-12-17 19:42:06 [INFO] [lib.training._linear:212] Feature stats: min=-0.8231, max=5173548124.1600, mean=31908764.6600
2025-12-17 19:42:06 [INFO] [lib.training._linear:227] Feature scaling completed. Scaled shape: (2622, 15)
2025-12-17 19:42:06 [INFO] [lib.training._linear:243] Training Logistic Regression...
2025-12-17 19:42:06 [INFO] [lib.training._linear:244] Training samples: 2622, Features: 15
2025-12-17 19:42:06 [INFO] [lib.training._linear:245] Label distribution: [1284 1338]
2025-12-17 19:42:07 [INFO] [lib.training._linear:250] ✓ Logistic Regression training completed
2025-12-17 19:42:07 [INFO] [lib.training._linear:264] ✓ Logistic Regression trained
2025-12-17 19:42:07 [INFO] [lib.training.pipeline:1336] Model.fit() completed successfully for fold 5
2025-12-17 19:42:07 [INFO] [lib.training.pipeline:1350] Starting model.predict() for logistic_regression fold 5...
2025-12-17 19:42:07 [INFO] [lib.training.pipeline:1351] Validation data: 655 rows
2025-12-17 19:42:07 [INFO] [lib.training._linear:312] Loading features for prediction (655 videos)...
2025-12-17 19:42:07 [INFO] [lib.training.feature_preprocessing:320] Loading Stage 2 features...
2025-12-17 19:42:07 [INFO] [lib.training.feature_preprocessing:321] Stage 2 path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-17 19:42:07 [INFO] [lib.training.feature_preprocessing:331] ✓ Loaded Stage 2 metadata: 3278 rows, 18 columns
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:369] Converting Stage 2 features to numpy array...
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:373] Stage 2 array shape: (655, 15), dtype: float64
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:376] Loaded 15 Stage 2 features (655/655 videos matched)
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:488] Combining 1 feature arrays...
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:489] Feature array shapes: [(655, 15)]
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:494] Combined 15 features from 1 stages
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:495] Combined feature matrix shape: (655, 15), dtype: float64
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:496] Combined feature matrix size: 0.07 MB
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:522] Stage 2 only: 655 videos with features
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:532] ✓ Found 655 videos with valid features
2025-12-17 19:42:13 [INFO] [lib.training.feature_preprocessing:537] All 655 videos have valid features
2025-12-17 19:42:13 [INFO] [lib.training._linear:323] ✓ Loaded features for prediction (shape: (655, 15))
2025-12-17 19:42:13 [INFO] [lib.training._linear:341] Scaling features for prediction (shape: (655, 15))...
2025-12-17 19:42:13 [INFO] [lib.training._linear:364] Running LogisticRegression.predict_proba()...
2025-12-17 19:42:13 [INFO] [lib.training._linear:369] ✓ Prediction completed (shape: (655, 2))
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:1356] Model.predict() completed successfully for fold 5
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:1403] Fold 5 - Val Loss: 0.6580, Val Acc: 0.6137, Val F1: 0.6442, Val Precision: 0.6074, Val Recall: 0.6856
2025-12-17 19:42:13 [INFO] [lib.training._linear:399] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:1419] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_5
2025-12-17 19:42:13 [ERROR] [lib.training.pipeline:1468] Error training baseline fold 5: name '_save_metrics_to_duckdb' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1422, in _train_baseline_model_fold
    _save_metrics_to_duckdb(result, model_type, fold_idx, project_root_str)
    ^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_save_metrics_to_duckdb' is not defined
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:115] Saved best model from fold 1: Copied 3 model file(s) from fold_1 to best_model
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:2452] 
logistic_regression - Avg Val Loss: 0.6550 ± 0.0130, Avg Val Acc: 0.5981 ± 0.0221, Avg Val F1: 0.6235 ± 0.0255
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:2456]   Avg Val Precision: 0.5967 ± 0.0174, Avg Val Recall: 0.6531 ± 0.0366
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:2460]   Class 0 - F1: 0.5688 ± 0.0188, Precision: 0.6004 ± 0.0286, Recall: 0.5408 ± 0.0163
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:2465]   Class 1 - F1: 0.6235 ± 0.0255, Precision: 0.5967 ± 0.0174, Recall: 0.6531 ± 0.0366
2025-12-17 19:42:13 [INFO] [lib.training.pipeline:2503] Saved aggregated metrics to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/metrics.json (model: logistic_regression)
2025-12-17 19:42:13 [ERROR] [lib.training.pipeline:2521] Failed to save metrics.json for logistic_regression: name '_check_airflow_status' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2517, in stage5_train_models
    airflow_status = _check_airflow_status(model_type, project_root_str)
                     ^^^^^^^^^^^^^^^^^^^^^
NameError: name '_check_airflow_status' is not defined
2025-12-17 19:42:17 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/plots/cv_fold_comparison.png
2025-12-17 19:42:18 [INFO] [lib.training.visualization:305] Saved hyperparameter search results to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/plots/hyperparameter_search.png
2025-12-17 19:42:18 [INFO] [lib.training.pipeline:2546] Generated plots for logistic_regression in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/plots
2025-12-17 19:42:18 [INFO] [lib.training.pipeline:2583] ================================================================================
2025-12-17 19:42:18 [INFO] [lib.training.pipeline:2584] Stage 5: Model Training Pipeline Completed
2025-12-17 19:42:18 [INFO] [lib.training.pipeline:2585] ================================================================================
2025-12-17 19:42:18 [INFO] [__main__:401] ================================================================================
2025-12-17 19:42:18 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-17 19:42:18 [INFO] [__main__:403] ================================================================================
2025-12-17 19:42:18 [INFO] [__main__:404] Execution time: 303.25 seconds (5.05 minutes)
2025-12-17 19:42:18 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-17 19:42:18 [INFO] [__main__:407] Models trained: ['logistic_regression']
2025-12-17 19:42:18 [INFO] [__main__:408] K-fold splits: 5
2025-12-17 19:42:18 [INFO] [__main__:414] ================================================================================
2025-12-17 19:42:18 [INFO] [__main__:415] Final memory statistics:
2025-12-17 19:42:18 [INFO] [__main__:416] ================================================================================
2025-12-17 19:42:18 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 941.6875, 'cpu_memory_gb': 0.91961669921875, 'cpu_vms_mb': 12410.28515625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-17 19:42:18 [INFO] [__main__:419] ================================================================================
2025-12-17 19:42:18 [INFO] [__main__:420] Training complete!
2025-12-17 19:42:18 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-17 19:42:18 [INFO] [__main__:422] ================================================================================
